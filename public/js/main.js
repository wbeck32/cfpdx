function makeBeerList(e){$.getJSON("/brewery/"+e+"/beers",function(e){}).done(function(a){var n=$("<div class='breweryBeers'></div>").attr("id",e);a.data?($(".breweryItem#"+e).after(n),$.each(a.data,function(e,r){var o=$("<div/>").attr("id",a.data[e].id).addClass("findById").append('<span class="displayName">'+a.data[e].nameDisplay+"</span>").append('<span class="abv"><span class="bold">ABV:&nbsp;</span>'+a.data[e].abv+"</span>").append('<span class="cta">About...</span>');n.append(o)})):($(".breweryItem#"+e).after(n),n.append("<div>Sorry, no beer data available for this brewery.</div>"))})}function findNearBeer(){var e=$("div.wrapper").attr("lat"),a=$("div.wrapper").attr("lng");$.getJSON("/findNearBeer/"+e+"/"+a,function(e){}).done(function(e){$.each(e,function(e,a){if("data"===e)for(var n,r=0;r<10;r++)n=void 0!==a[r].brewery.images?a[r].brewery.images.icon:"../images/beer.png",$("<div/>").attr("id",a[r].brewery.id).addClass("breweryItem").html('<span class="icon"><img src="'+n+'"></span>').append('<div class="breweryName">'+a[r].brewery.name+"</div>").append('<div class="breweryAddress">'+a[r].streetAddress+"</div>").append('<div class="breweryPhone">'+a[r].phone+"</div>").appendTo(".beerData"),$(".breweryItem#"+a[r].brewery.id).before('<div class="toggle" id="'+a[r].brewery.id+'">Show/hide beers</div>')})})}function findMe(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var a={lat:e.coords.latitude,lng:e.coords.longitude};fetch("https://maps.googleapis.com/maps/api/geocode/json?latlng="+a.lat+","+a.lng+"&key=AIzaSyDK--2y9KY9N_bTw1WY1qSB0ub_4kuCbmk").then(function(e){return e.json()}).then(function(e){$(".wrapper").attr({lat:a.lat,lng:a.lng}),$(".loader").addClass("locationFound"),$(".display").css("visibility","visible"),findNearBeer();var n={lat:a.lat,lng:a.lng};map=new google.maps.Map(document.getElementById("map"),{center:n,zoom:15}),infowindow=new google.maps.InfoWindow({content:"You are here.",position:n}),infowindow.open(map)}).catch(function(e){console.log(e)})},function(){handleLocationError(!0,infoWindow,map.getCenter())}):handleLocationError(!1,infoWindow,map.getCenter())}function handleLocationError(e,a,n){a.setPosition(n),a.setContent(e?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation."),a.open(map)}$(".beerData").on("click",".toggle",function(){$(".loader.locationFound").remove();var e=$(this).attr("id");$(".beerData .breweryBeers#"+e).length>0?$(".beerData .breweryBeers#"+e).remove():($(".breweryBeers").not(".breweryBeers#"+e).remove(),makeBeerList(e))}),$(".beerData").on("click",".findById",function(){var e=$(this).attr("id");$(".beerInfo").remove(),$.getJSON("/beer/"+e,function(e){}).done(function(e){$.each(e,function(e,a){if("data"===e){console.log(a);var n=$('<div class="beerInfo"/>').attr("id",a.id).html("<span>Info about this beer!</span>");$(".findById#"+a.id).after(n)}})})});var map,marker,infoWindow;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpc3BsYXkuanMiLCJtYXBzLmpzIl0sIm5hbWVzIjpbIm1ha2VCZWVyTGlzdCIsImJyZXdlcnlJZCIsIiQiLCJnZXRKU09OIiwiZGF0YSIsImRvbmUiLCJiZWVyTGlzdCIsImF0dHIiLCJhZnRlciIsImVhY2giLCJrZXkiLCJ2YWx1ZSIsImJlZXJJbmZvIiwiaWQiLCJhZGRDbGFzcyIsImFwcGVuZCIsIm5hbWVEaXNwbGF5IiwiYWJ2IiwiZmluZE5lYXJCZWVyIiwibGF0IiwibG5nIiwidmFsIiwiaWNvbiIsIm0iLCJ1bmRlZmluZWQiLCJicmV3ZXJ5IiwiaW1hZ2VzIiwiaHRtbCIsIm5hbWUiLCJzdHJlZXRBZGRyZXNzIiwicGhvbmUiLCJhcHBlbmRUbyIsImJlZm9yZSIsImZpbmRNZSIsIm5hdmlnYXRvciIsImdlb2xvY2F0aW9uIiwiZ2V0Q3VycmVudFBvc2l0aW9uIiwicG9zaXRpb24iLCJwb3MiLCJjb29yZHMiLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsImZldGNoIiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsImNzcyIsImNlbnRlciIsIm1hcCIsImdvb2dsZSIsIm1hcHMiLCJNYXAiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiem9vbSIsImluZm93aW5kb3ciLCJJbmZvV2luZG93IiwiY29udGVudCIsIm9wZW4iLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsImhhbmRsZUxvY2F0aW9uRXJyb3IiLCJpbmZvV2luZG93IiwiZ2V0Q2VudGVyIiwiYnJvd3Nlckhhc0dlb2xvY2F0aW9uIiwic2V0UG9zaXRpb24iLCJzZXRDb250ZW50Iiwib24iLCJyZW1vdmUiLCJ0aGlzIiwibGVuZ3RoIiwibm90IiwiYmVlcklkIiwibWFya2VyIl0sIm1hcHBpbmdzIjoiQUE2QkEsU0FBQUEsYUFBQUMsR0FDQUMsRUFBQUMsUUFBQSxZQUFBRixFQUFBLFNBQUEsU0FBQUcsTUFHQUMsS0FBQSxTQUFBRCxHQUNBLElBQUFFLEVBQUFKLEVBQUEs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cUUsVUFFQXBFLEVBQUEsaUJBQUF1RSxJQUFBLGlCQUFBeEUsR0FBQXFFLFNBQ0F0RSxhQUFBQyxNQUlBQyxFQUFBLGFBQUFtRSxHQUFBLFFBQUEsWUFBQSxXQUNBLElBQUFLLEVBQUF4RSxFQUFBcUUsTUFBQWhFLEtBQUEsTUFDQUwsRUFBQSxhQUFBb0UsU0FDQXBFLEVBQUFDLFFBQUEsU0FBQXVFLEVBQUEsU0FBQXRFLE1BRUFDLEtBQUEsU0FBQUQsR0FDQUYsRUFBQU8sS0FBQUwsRUFBQSxTQUFBTSxFQUFBVyxHQUNBLEdBQUEsU0FBQVgsRUFBQSxDQUNBbUQsUUFBQUMsSUFBQXpDLEdBQ0EsSUFBQVQsRUFBQVYsRUFBQSwyQkFDQUssS0FBQSxLQUFBYyxFQUFBUixJQUNBYyxLQUFBLHNDQUNBekIsRUFBQSxhQUFBbUIsRUFBQVIsSUFBQUwsTUFBQUksVUN2QkEsSUFBQW9DLElBQUEyQixPQUFBWCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJCgnLmJlZXJEYXRhJykub24oJ2NsaWNrJywgJy50b2dnbGUnLCBmdW5jdGlvbigpIHtcbiAgJCgnLmxvYWRlci5sb2NhdGlvbkZvdW5kJykucmVtb3ZlKCk7XG4gIHZhciBicmV3ZXJ5SWQgPSAkKHRoaXMpLmF0dHIoJ2lkJyk7XG4gIGlmKCQoJy5iZWVyRGF0YSAuYnJld2VyeUJlZXJzIycrYnJld2VyeUlkKS5sZW5ndGggPiAwKSB7XG4gICAgJCgnLmJlZXJEYXRhIC5icmV3ZXJ5QmVlcnMjJyticmV3ZXJ5SWQpLnJlbW92ZSgpO1xuICB9IGVsc2Uge1xuICAgICQoJy5icmV3ZXJ5QmVlcnMnKS5ub3QoJy5icmV3ZXJ5QmVlcnMjJyticmV3ZXJ5SWQpLnJlbW92ZSgpO1xuICAgIG1ha2VCZWVyTGlzdChicmV3ZXJ5SWQpO1xuICB9XG59KTtcblxuJCgnLmJlZXJEYXRhJykub24oJ2NsaWNrJywgJy5maW5kQnlJZCcsIGZ1bmN0aW9uKCkge1xuICB2YXIgYmVlcklkID0gJCh0aGlzKS5hdHRyKCdpZCcpO1xuICAkKCcuYmVlckluZm8nKS5yZW1vdmUoKTtcbiAgJC5nZXRKU09OKCBcIi9iZWVyL1wiK2JlZXJJZCwgZnVuY3Rpb24oZGF0YSkge1xuICB9KVxuICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgJC5lYWNoKCBkYXRhLCBmdW5jdGlvbigga2V5LCB2YWwgKSB7XG4gICAgICBpZihrZXkgPT09ICdkYXRhJykge1xuICAgICAgICBjb25zb2xlLmxvZyh2YWwpO1xuICAgICAgICB2YXIgYmVlckluZm8gPSAkKCc8ZGl2IGNsYXNzPVwiYmVlckluZm9cIi8+JylcbiAgICAgICAgLmF0dHIoJ2lkJyx2YWwuaWQpXG4gICAgICAgIC5odG1sKCc8c3Bhbj5JbmZvIGFib3V0IHRoaXMgYmVlciE8L3NwYW4+Jyk7XG4gICAgICAgICQoJy5maW5kQnlJZCMnK3ZhbC5pZCkuYWZ0ZXIoYmVlckluZm8pO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5mdW5jdGlvbiBtYWtlQmVlckxpc3QoYnJld2VyeUlkKSB7XG4gICQuZ2V0SlNPTiggXCIvYnJld2VyeS9cIiticmV3ZXJ5SWQrXCIvYmVlcnNcIiwgZnVuY3Rpb24oZGF0YSkge1xuICAvLyBjb25zb2xlLmxvZygnc3VjY2VzcycpO1xuICB9KVxuICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgdmFyIGJlZXJMaXN0ID0gJChcIjxkaXYgY2xhc3M9J2JyZXdlcnlCZWVycyc+PC9kaXY+XCIpXG4gICAgLmF0dHIoJ2lkJywgYnJld2VyeUlkKTtcbiAgICBpZihkYXRhLmRhdGEpIHtcbiAgICAgICQoJy5icmV3ZXJ5SXRlbSMnK2JyZXdlcnlJZCkuYWZ0ZXIoYmVlckxpc3QpO1xuICAgICAgJC5lYWNoKGRhdGEuZGF0YSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgICB2YXIgYmVlckluZm8gPSAkKCc8ZGl2Lz4nKVxuICAgICAgICAuYXR0cignaWQnLCBkYXRhLmRhdGFba2V5XS5pZClcbiAgICAgICAgLmFkZENsYXNzKCdmaW5kQnlJZCcpXG4gICAgICAgIC5hcHBlbmQoJzxzcGFuIGNsYXNzPVwiZGlzcGxheU5hbWVcIj4nK2RhdGEuZGF0YVtrZXldLm5hbWVEaXNwbGF5Kyc8L3NwYW4+JylcbiAgICAgICAgLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJhYnZcIj48c3BhbiBjbGFzcz1cImJvbGRcIj5BQlY6Jm5ic3A7PC9zcGFuPicrZGF0YS5kYXRhW2tleV0uYWJ2Kyc8L3NwYW4+JylcbiAgICAgICAgLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJjdGFcIj5BYm91dC4uLjwvc3Bhbj4nKTtcbiAgICAgICAgYmVlckxpc3QuYXBwZW5kKGJlZXJJbmZvKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKCcuYnJld2VyeUl0ZW0jJyticmV3ZXJ5SWQpLmFmdGVyKGJlZXJMaXN0KTtcbiAgICAgIGJlZXJMaXN0LmFwcGVuZCgnPGRpdj5Tb3JyeSwgbm8gYmVlciBkYXRhIGF2YWlsYWJsZSBmb3IgdGhpcyBicmV3ZXJ5LjwvZGl2PicpO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGZpbmROZWFyQmVlcigpIHtcbiAgdmFyIGxhdCA9ICQoJ2Rpdi53cmFwcGVyJykuYXR0cignbGF0Jyk7XG4gIHZhciBsbmcgPSAkKCdkaXYud3JhcHBlcicpLmF0dHIoJ2xuZycpO1xuICAkLmdldEpTT04oIFwiL2ZpbmROZWFyQmVlci9cIitsYXQrXCIvXCIrbG5nLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ3N1Y2Nlc3MnKTtcbiAgfSlcbiAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICQuZWFjaCggZGF0YSwgZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICAgICAgaWYoa2V5ID09PSAnZGF0YScpIHtcbiAgICAgICAgICB2YXIgaWNvbjtcbiAgICAgICAgICBmb3IgKHZhciBtID0gMDsgbSA8IDEwOyBtKyspIHtcbiAgICAgICAgICAgIGlmKHZhbFttXS5icmV3ZXJ5LmltYWdlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIGljb24gPSB2YWxbbV0uYnJld2VyeS5pbWFnZXMuaWNvbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGljb24gPSAnLi4vaW1hZ2VzL2JlZXIucG5nJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQoJzxkaXYvPicpXG4gICAgICAgICAgICAuYXR0cignaWQnLHZhbFttXS5icmV3ZXJ5LmlkKVxuICAgICAgICAgICAgLmFkZENsYXNzKCdicmV3ZXJ5SXRlbScpXG4gICAgICAgICAgICAuaHRtbCgnPHNwYW4gY2xhc3M9XCJpY29uXCI+PGltZyBzcmM9XCInK2ljb24rJ1wiPjwvc3Bhbj4nKVxuICAgICAgICAgICAgLmFwcGVuZCgnPGRpdiBjbGFzcz1cImJyZXdlcnlOYW1lXCI+Jyt2YWxbbV0uYnJld2VyeS5uYW1lKyc8L2Rpdj4nKVxuICAgICAgICAgICAgLmFwcGVuZCgnPGRpdiBjbGFzcz1cImJyZXdlcnlBZGRyZXNzXCI+Jyt2YWxbbV0uc3RyZWV0QWRkcmVzcysnPC9kaXY+JylcbiAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCJicmV3ZXJ5UGhvbmVcIj4nK3ZhbFttXS5waG9uZSsnPC9kaXY+JylcbiAgICAgICAgICAgIC5hcHBlbmRUbygnLmJlZXJEYXRhJyk7XG4gICAgICAgICAgICAkKCcuYnJld2VyeUl0ZW0jJyt2YWxbbV0uYnJld2VyeS5pZCkuYmVmb3JlKCc8ZGl2IGNsYXNzPVwidG9nZ2xlXCIgaWQ9XCInK3ZhbFttXS5icmV3ZXJ5LmlkKydcIj5TaG93L2hpZGUgYmVlcnM8L2Rpdj4nKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG4iLCJ2YXIgbWFwLCBtYXJrZXIsIGluZm9XaW5kb3c7XG5mdW5jdGlvbiBmaW5kTWUoKSB7XG4gICAvLyBUcnkgSFRNTDUgZ2VvbG9jYXRpb24uXG5pZiAobmF2aWdhdG9yLmdlb2xvY2F0aW9uKSB7XG4gIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24oZnVuY3Rpb24ocG9zaXRpb24pIHtcbiAgdmFyIHBvcyA9IHtcbiAgICBsYXQ6IHBvc2l0aW9uLmNvb3Jkcy5sYXRpdHVkZSxcbiAgICBsbmc6IHBvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGVcbiAgfTtcbiAgZmV0Y2goJ2h0dHBzOi8vbWFwcy5nb29nbGVhcGlzLmNvbS9tYXBzL2FwaS9nZW9jb2RlL2pzb24/bGF0bG5nPScrcG9zLmxhdCsnLCcrcG9zLmxuZysnJmtleT1BSXphU3lESy0tMnk5S1k5Tl9iVHcxV1kxcVNCMHViXzRrdUNibWsnKVxuICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7IHJldHVybiByZXNwb25zZS5qc29uKCk7IH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgJCgnLndyYXBwZXInKS5hdHRyKHtcbiAgICAgICAgbGF0IDogcG9zLmxhdCxcbiAgICAgICAgbG5nIDogcG9zLmxuZ1xuICAgICAgfSk7XG4gICAgICAkKCcubG9hZGVyJykuYWRkQ2xhc3MoJ2xvY2F0aW9uRm91bmQnKTtcbiAgICAgICQoJy5kaXNwbGF5JykuY3NzKCd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTtcbiAgICAgIGZpbmROZWFyQmVlcigpO1xuICAgICAgdmFyIGNlbnRlciA9IHsnbGF0JzogcG9zLmxhdCwgJ2xuZyc6IHBvcy5sbmd9O1xuICAgICAgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcbiAgICAgICAgY2VudGVyOiBjZW50ZXIsXG4gICAgICAgIHpvb206IDE1XG4gICAgICB9KTtcbiAgICAgIGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XG4gICAgICAgICAgY29udGVudDogJ1lvdSBhcmUgaGVyZS4nLFxuICAgICAgICAgIHBvc2l0aW9uOiBjZW50ZXJcbiAgICAgICAgfSk7XG4gICAgICBpbmZvd2luZG93Lm9wZW4obWFwKTtcbiAgICB9KVxuICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIH0pO1xuICB9LCBmdW5jdGlvbigpIHtcbiAgICBoYW5kbGVMb2NhdGlvbkVycm9yKHRydWUsIGluZm9XaW5kb3csIG1hcC5nZXRDZW50ZXIoKSk7XG4gIH0pO1xuICB9IGVsc2Uge1xuICAgIC8vIEJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IEdlb2xvY2F0aW9uXG4gICAgaGFuZGxlTG9jYXRpb25FcnJvcihmYWxzZSwgaW5mb1dpbmRvdywgbWFwLmdldENlbnRlcigpKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVMb2NhdGlvbkVycm9yKGJyb3dzZXJIYXNHZW9sb2NhdGlvbiwgaW5mb1dpbmRvdywgcG9zKSB7XG4gIGluZm9XaW5kb3cuc2V0UG9zaXRpb24ocG9zKTtcbiAgaW5mb1dpbmRvdy5zZXRDb250ZW50KGJyb3dzZXJIYXNHZW9sb2NhdGlvbiA/XG4gICAgJ0Vycm9yOiBUaGUgR2VvbG9jYXRpb24gc2VydmljZSBmYWlsZWQuJyA6XG4gICAgJ0Vycm9yOiBZb3VyIGJyb3dzZXIgZG9lc25cXCd0IHN1cHBvcnQgZ2VvbG9jYXRpb24uJyk7XG4gIGluZm9XaW5kb3cub3BlbihtYXApO1xufVxuIl19
